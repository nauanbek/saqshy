# =============================================================================
# SAQSHY Production Environment Configuration
# =============================================================================
# Copy this file to .env.prod on your production server
# NEVER commit .env.prod to version control
#
# Generate secure secrets with:
#   openssl rand -hex 32
# =============================================================================

# -----------------------------------------------------------------------------
# Telegram Bot Settings (REQUIRED)
# -----------------------------------------------------------------------------
# Get your bot token from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather

# Public URL where your bot is accessible (must be HTTPS)
WEBHOOK_BASE_URL=https://your-domain.com

# Secret for webhook verification (generate with: openssl rand -hex 32)
WEBHOOK_SECRET=generate_with_openssl_rand_hex_32

# -----------------------------------------------------------------------------
# Database Settings (REQUIRED)
# -----------------------------------------------------------------------------
# PostgreSQL connection string for the bot
# In Docker, use 'postgres' as host (service name)
DATABASE_URL=postgresql+asyncpg://saqshy:your_secure_password@postgres:5432/saqshy

# Connection pool settings (adjust based on expected load)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30

# PostgreSQL container credentials (must match DATABASE_URL)
POSTGRES_USER=saqshy
POSTGRES_PASSWORD=your_secure_password_here
POSTGRES_DB=saqshy

# -----------------------------------------------------------------------------
# Redis Settings (REQUIRED)
# -----------------------------------------------------------------------------
# In Docker, use 'redis' as host (service name)
REDIS_URL=redis://redis:6379/0

# -----------------------------------------------------------------------------
# Qdrant Vector Database Settings (REQUIRED)
# -----------------------------------------------------------------------------
# In Docker, use 'qdrant' as host (service name)
QDRANT_URL=http://qdrant:6333
QDRANT_COLLECTION=spam_embeddings

# -----------------------------------------------------------------------------
# Claude API Settings (REQUIRED)
# -----------------------------------------------------------------------------
# Get your API key from https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your_anthropic_api_key_here

# Model for gray zone decisions
CLAUDE_MODEL=claude-sonnet-4-20250514

# -----------------------------------------------------------------------------
# Cohere Embeddings Settings (REQUIRED)
# -----------------------------------------------------------------------------
# Get your API key from https://dashboard.cohere.com/
COHERE_API_KEY=your_cohere_api_key_here

# Embedding model (do not change unless migrating)
COHERE_MODEL=embed-multilingual-v3.0

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# MUST be false in production
DEBUG=false

# Environment identifier
ENVIRONMENT=production

# Default settings for new groups
DEFAULT_GROUP_TYPE=general
DEFAULT_SENSITIVITY=5

# -----------------------------------------------------------------------------
# Mini App Settings (REQUIRED for admin dashboard)
# -----------------------------------------------------------------------------
# URL where Mini App is served (usually same as webhook base)
MINI_APP_URL=https://your-domain.com/app

# JWT secret for API authentication (generate with: openssl rand -hex 32)
JWT_SECRET=generate_with_openssl_rand_hex_32

# JWT configuration
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=60

# -----------------------------------------------------------------------------
# Bot Server Settings
# -----------------------------------------------------------------------------
# Internal binding (Docker handles external routing via Nginx)
BOT_HOST=0.0.0.0
BOT_PORT=8080

# -----------------------------------------------------------------------------
# GitHub Container Registry (for CI/CD deployment)
# -----------------------------------------------------------------------------
# These are configured as GitHub Actions secrets, not in .env file:
#
# GHCR_DEPLOY_TOKEN: A GitHub Personal Access Token (classic) with:
#   - read:packages permission
#   - Used to pull images from ghcr.io on the VPS
#   - Create at: https://github.com/settings/tokens
#   - IMPORTANT: Use a dedicated token, NOT GITHUB_TOKEN (which expires)
#
# The CI workflow uses GITHUB_TOKEN for pushing, but deployment uses
# GHCR_DEPLOY_TOKEN for pulling on the VPS.

# -----------------------------------------------------------------------------
# SSH Deployment (for CI/CD)
# -----------------------------------------------------------------------------
# These MUST be configured as GitHub Actions secrets (Settings > Secrets):
#
# SSH_HOST: IP address or hostname of your VPS
# SSH_USER: Username for SSH (e.g., 'deploy' - should have minimal permissions)
# SSH_KEY: Private key contents (id_ed25519 or id_rsa)
#          Generate with: ssh-keygen -t ed25519 -C "github-deploy"
# GHCR_DEPLOY_TOKEN: Personal Access Token for ghcr.io (see above)
#
# VPS Setup Requirements:
# 1. Create deploy user: sudo adduser deploy
# 2. Add to docker group: sudo usermod -aG docker deploy
# 3. Add public key to: /home/deploy/.ssh/authorized_keys
# 4. Disable password auth in /etc/ssh/sshd_config

# =============================================================================
# SECURITY CHECKLIST
# =============================================================================
# Before deploying, verify:
# [ ] TELEGRAM_BOT_TOKEN is from production bot (not test bot)
# [ ] POSTGRES_PASSWORD is strong (16+ chars, mixed case, numbers, symbols)
# [ ] WEBHOOK_SECRET is randomly generated (32+ hex chars)
# [ ] JWT_SECRET is randomly generated (32+ hex chars)
# [ ] DEBUG is set to false
# [ ] ENVIRONMENT is set to production
# [ ] All API keys are production keys (not test/sandbox)
# [ ] This file is NOT committed to version control
# =============================================================================
